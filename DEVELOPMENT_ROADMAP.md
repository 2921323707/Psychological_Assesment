# 开发路线图

## 🎯 阶段一：核心测评功能（1-2周）

### 任务1：量表测评界面 ⭐⭐⭐
**优先级：最高**

#### 需要创建的文件：
- `app/templates/test.html` - 测评页面模板
- `app/static/js/test.js` - 测评交互逻辑

#### 功能需求：
- [ ] 显示量表信息（名称、说明、指导语）
- [ ] 逐题展示题目
- [ ] 单选题/多选题选项展示
- [ ] 答题进度条
- [ ] 上一题/下一题导航
- [ ] 答题状态保存（防止刷新丢失）
- [ ] 提交验证（确保所有题目已答）

#### API需要实现：
- `GET /api/scales/<id>/items` - 获取量表题目列表

---

### 任务2：数据库初始化 ⭐⭐⭐
**优先级：最高**

#### 需要创建的文件：
- `scripts/init_database.py` - 数据库初始化脚本
- `scripts/load_scales.py` - 量表数据导入脚本（可选）

#### 功能需求：
- [ ] 初始化数据库表结构
- [ ] 导入至少2-3个完整的量表（SDS、SAS等）
- [ ] 确保题目、选项、评分规则完整
- [ ] 验证数据完整性

#### 数据库字段补充：
- `ScaleItem` 模型需要添加：
  - `options` (JSON) - 选项列表
  - `scoring_rule` (JSON) - 评分规则

---

### 任务3：评分算法 ⭐⭐⭐
**优先级：最高**

#### 修改文件：
- `app/routes.py` - `submit_test` 函数

#### 功能需求：
- [ ] 实现不同量表的评分逻辑
- [ ] SDS评分（反向计分）
- [ ] SAS评分
- [ ] 结果等级判定（正常/轻度/中度/重度）
- [ ] 因子分计算（如SCL-90）

#### 需要创建：
- `app/utils/scoring.py` - 评分工具模块

---

### 任务4：测评报告 ⭐⭐⭐
**优先级：高**

#### 需要创建的文件：
- `app/templates/report.html` - 报告页面
- `app/static/js/report.js` - 报告交互

#### 功能需求：
- [ ] 显示总分和等级
- [ ] 结果解释文字
- [ ] 建议和指导
- [ ] 简单的图表可视化（可选）
- [ ] PDF导出功能（可选）

#### API需要实现：
- `GET /api/test/<test_id>` - 获取测试结果详情

---

## 🎨 阶段二：用户体验优化（1周）

### 任务5：量表详情页优化
- [ ] 点击量表卡片查看详情
- [ ] 添加量表预览功能
- [ ] 优化量表列表UI

### 任务6：测评流程优化
- [ ] 添加测评说明页面
- [ ] 优化答题界面交互
- [ ] 添加答题提示
- [ ] 防止误操作（如后退导致数据丢失）

---

## 👤 阶段三：用户系统（可选，1-2周）

### 任务7：用户注册登录
- [ ] 实现注册/登录页面
- [ ] 使用Flask-Login管理会话
- [ ] 密码加密（Flask-Bcrypt）
- [ ] 用户个人信息页面

### 任务8：测评历史
- [ ] 用户测评历史列表
- [ ] 结果对比功能
- [ ] 历史报告查看

---

## 📊 阶段四：高级功能（按需开发）

### 任务9：数据可视化
- [ ] 使用Chart.js或其他图表库
- [ ] 分数趋势图
- [ ] 多维度对比图

### 任务10：搜索和筛选
- [ ] 量表搜索功能
- [ ] 按分类筛选
- [ ] 按时间筛选

### 任务11：个性化推荐
- [ ] 基于历史测评推荐量表
- [ ] 智能匹配算法

---

## 🛠️ 技术债务和改进

- [ ] 添加单元测试
- [ ] API文档（Swagger/Flask-RESTX）
- [ ] 错误处理和日志
- [ ] 性能优化（数据库索引）
- [ ] 安全性增强（CSRF保护、SQL注入防护）

---

## 📝 实施建议

### 第一步：立即开始
1. **创建测评界面** - 这是用户最核心的需求
2. **导入至少一个完整的量表到数据库** - 便于测试
3. **实现评分算法** - 让系统真正可用

### 第二步：完善体验
4. **优化测评流程** - 提升用户体验
5. **实现报告功能** - 给用户反馈

### 第三步：扩展功能
6. 根据实际需求决定是否添加用户系统
7. 逐步完善其他高级功能

---

## 💡 快速启动建议

**如果时间有限，最小可用版本（MVP）包含：**
1. ✅ 量表列表展示（已有）
2. ⏳ 一个量表的完整测评流程（SDS）
3. ⏳ 评分和报告生成
4. ⏳ 结果查看

**这样可以快速验证核心功能，然后再逐步完善。**

